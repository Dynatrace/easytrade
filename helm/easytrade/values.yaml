global:
  image:
    tag: latest

accountservice:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/accountservice
  env:
    MANAGER_HOSTANDPORT: "{{ .Release.Name }}-manager:8080"
    PROXY_PREFIX: "accountservice"
  resources:
    requests:
      cpu: 30m
      memory: 600Mi
    limits:
      cpu: 200m
      memory: 600Mi
  service:
    enabled: true
    port: 8080

aggregator-service:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/aggregator-service
  env:
    OFFER_SERVICE_PROTOCOL: "http"
    OFFER_SERVICE_HOST: "{{ .Release.Name }}-offerservice"
    OFFER_SERVICE_PORT: "8080"
  resources:
    requests:
      cpu: 10m
      memory: 30Mi
    limits:
      cpu: 200m
      memory: 30Mi

broker-service:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/broker-service
  env:
    ACCOUNTSERVICE_HOSTANDPORT: "{{ .Release.Name }}-accountservice:8080"
    PRICINGSERVICE_HOSTANDPORT: "{{ .Release.Name }}-pricing-service:8080"
    ENGINE_HOSTANDPORT: "{{ .Release.Name }}-engine:8080"
    FEATURE_FLAG_SERVICE_PROTOCOL: http
    FEATURE_FLAG_SERVICE_BASE_URL: "{{ .Release.Name }}-feature-flag-service"
    FEATURE_FLAG_SERVICE_PORT: "8080"
    PROXY_PREFIX: "broker-service"
  envFromSecret:
    MSSQL_CONNECTIONSTRING:
      name: "{{ .Release.Name }}-connection-strings"
      key: "DOTNET_CONNECTION_STRING"
  resources:
    requests:
      cpu: 150m
      memory: 350Mi
    limits:
      cpu: 600m
      memory: 350Mi
  service:
    enabled: true
    port: 8080

calculationservice:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/calculationservice
  env:
    RABBITMQ_USER: userxxx
    RABBITMQ_PASSWORD: passxxx
    RABBITMQ_HOST: rabbitmq
    RABBITMQ_PORT: "5672"
    RABBITMQ_QUEUE: Trade_Data_Raw
  resources:
    requests:
      cpu: 10m
      memory: 25Mi
    limits:
      cpu: 100m
      memory: 25Mi

contentcreator:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/contentcreator
  envFromSecret:
    MSSQL_CONNECTIONSTRING:
      name: "{{ .Release.Name }}-connection-strings"
      key: "JAVA_CONNECTION_STRING"
  resources:
    requests:
      cpu: 10m
      memory: 400Mi
    limits:
      cpu: 200m
      memory: 400Mi

credit-card-order-service:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/credit-card-order-service
  env:
    PROXY_PREFIX: "credit-card-order-service"
    THIRD_PARTY_SERVICE_HOSTANDPORT: "{{ .Release.Name }}-third-party-service:8080"
    WORK_DELAY: "300"
    WORK_RATE: "900"
    JAVA_TOOL_OPTIONS: "-XX:-OmitStackTraceInFastThrow"
  envFromSecret:
    MSSQL_CONNECTIONSTRING:
      name: "{{ .Release.Name }}-connection-strings"
      key: "JAVA_CONNECTION_STRING"
  resources:
    requests:
      cpu: 20m
      memory: 650Mi
    limits:
      cpu: 500m
      memory: 650Mi
  service:
    enabled: true
    port: 8080

db:
  enabled: true
  workloadType: statefulset
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/db
  envFromSecret:
    SA_PASSWORD:
      name: "{{ .Release.Name }}-connection-strings"
      key: "SA_PASSWORD"
  resources:
    requests:
      cpu: 500m
      memory: 1.5Gi
    limits:
      cpu: "2"
      memory: 1.5Gi
  service:
    enabled: true
    port: 1433
  persistence:
    enabled: true
    mountPath: /var/opt/mssql
    size: 10Gi

engine:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/engine
  env:
    BROKER_HOSTANDPORT: "{{ .Release.Name }}-broker-service:8080"
    PROXY_PREFIX: "engine"
  resources:
    requests:
      cpu: 10m
      memory: 450Mi
    limits:
      cpu: 200m
      memory: 450Mi
  service:
    enabled: true
    port: 8080

feature-flag-service:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/feature-flag-service
  env:
    FEATURE_FLAG_SERVICE_PROTOCOL: http
    FEATURE_FLAG_SERVICE_BASE_URL: "{{ .Release.Name }}-feature-flag-service"
    FEATURE_FLAG_SERVICE_PORT: "8080"
  resources:
    requests:
      cpu: 30m
      memory: 600Mi
    limits:
      cpu: 200m
      memory: 600Mi
  service:
    enabled: true
    port: 8080

frontend:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/frontend
  resources:
    requests:
      cpu: 10m
      memory: 75Mi
    limits:
      cpu: 100m
      memory: 75Mi
  service:
    enabled: true
    port: 3000

frontendreverseproxy:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/frontendreverseproxy
  resources:
    requests:
      cpu: 50m
      memory: 100Mi
    limits:
      cpu: 200m
      memory: 100Mi
  service:
    enabled: true
    port: 80

loadgen:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/loadgen
  env:
    EASYTRADE_URL: "http://{{ .Release.Name }}-frontendreverseproxy"
    RARE_VISITS_INTERVAL_MINUTES: "60"
  resources:
    requests:
      cpu: "1"
      memory: 256Mi
    limits:
      cpu: "2"
      memory: 2Gi

loginservice:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/loginservice
  env:
    PROXY_PREFIX: "{{ .Release.Name }}-loginservice"
  envFromSecret:
    MSSQL_CONNECTIONSTRING:
      name: "{{ .Release.Name }}-connection-strings"
      key: "DOTNET_CONNECTION_STRING"
  resources:
    requests:
      cpu: 20m
      memory: 450Mi
    limits:
      cpu: 1
      memory: 450Mi
  service:
    enabled: true
    port: 8080

manager:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/manager

offerservice:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/offerservice

pricing-service:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/pricing-service

problem-operator:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/problem-operator

rabbitmq:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/rabbitmq

third-party-service:
  enabled: true
  image:
    repository: europe-docker.pkg.dev/dynatrace-demoability/docker/easytrade/third-party-service
